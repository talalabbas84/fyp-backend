{"code":"!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=0)}([function(e,t,n){n(1)},function(e,t,n){\"use strict\";const r=n(2);e.exports=function(e){function t(t,n,r){if(e.skip(t,n))return r();const i=e.keyGenerator(t,n);e.store.incr(i,function(s,o,a){if(s)return r(s);const u=\"function\"==typeof e.max?e.max(t,n):e.max;Promise.resolve(u).catch(r).then(s=>{var u=Math.ceil,c=Math.max;if(t.rateLimit={limit:s,current:o,remaining:c(s-o,0),resetTime:a},e.headers&&!n.headersSent&&(n.setHeader(\"X-RateLimit-Limit\",s),n.setHeader(\"X-RateLimit-Remaining\",t.rateLimit.remaining),a instanceof Date&&(n.setHeader(\"Date\",(new Date).toGMTString()),n.setHeader(\"X-RateLimit-Reset\",u(a.getTime()/1e3)))),e.draft_polli_ratelimit_headers&&!n.headersSent&&(n.setHeader(\"RateLimit-Limit\",s),n.setHeader(\"RateLimit-Remaining\",t.rateLimit.remaining),a)){const e=u((a.getTime()-Date.now())/1e3);n.setHeader(\"RateLimit-Reset\",c(0,e))}if(e.skipFailedRequests||e.skipSuccessfulRequests){let t=!1;const r=()=>{t||(e.store.decrement(i),t=!0)};e.skipFailedRequests&&(n.on(\"finish\",function(){400<=n.statusCode&&r()}),n.on(\"close\",()=>{n.finished||r()}),n.on(\"error\",()=>r())),e.skipSuccessfulRequests&&n.on(\"finish\",function(){400>n.statusCode&&e.store.decrement(i)})}return s&&o===s+1&&e.onLimitReached(t,n,e),s&&o>s?(e.headers&&!n.headersSent&&n.setHeader(\"Retry-After\",u(e.windowMs/1e3)),e.handler(t,n,r)):void r()})})}if((e=Object.assign({windowMs:6e4,max:5,message:\"Too many requests, please try again later.\",statusCode:429,headers:!0,draft_polli_ratelimit_headers:!1,skipFailedRequests:!1,skipSuccessfulRequests:!1,keyGenerator:function(e){return e.ip},skip:function(){return!1},handler:function(t,n){n.status(e.statusCode).send(e.message)},onLimitReached:function(){}},e)).store=e.store||new r(e.windowMs),\"function\"!=typeof e.store.incr||\"function\"!=typeof e.store.resetKey||e.skipFailedRequests&&\"function\"!=typeof e.store.decrement)throw new Error(\"The store is not valid.\");return[\"global\",\"delayMs\",\"delayAfter\"].forEach(t=>{if(e[t])throw new Error(`The ${t} option was removed from express-rate-limit v3.`)}),t.resetKey=e.store.resetKey.bind(e.store),t.resetIp=t.resetKey,t}},function(e){\"use strict\";function t(e){const t=new Date;return t.setMilliseconds(t.getMilliseconds()+e),t}e.exports=function(e){let n={},r=t(e);this.incr=function(e,t){n[e]?n[e]++:n[e]=1,t(null,n[e],r)},this.decrement=function(e){n[e]&&n[e]--},this.resetAll=function(){n={},r=t(e)},this.resetKey=function(e){delete n[e],delete r[e]};const i=setInterval(this.resetAll,e);i.unref&&i.unref()}}]);","extractedComments":[]}